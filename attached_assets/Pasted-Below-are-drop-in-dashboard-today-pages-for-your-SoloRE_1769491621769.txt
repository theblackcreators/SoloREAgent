Below are drop-in dashboard + today pages for your SoloREAgent Leveling System (Next.js App Router + Tailwind + Supabase).

They assume you already have:
	•	lib/supabaseClient.ts
	•	app/api/log/route.ts (multi-agent version)
	•	app/api/generate-daily/route.ts (cron)
	•	RLS policies from earlier

⸻

1) Small helpers + UI components

lib/date.ts

export function localISODate(d = new Date()) {
  // YYYY-MM-DD in user's local timezone
  const yyyy = d.getFullYear();
  const mm = String(d.getMonth() + 1).padStart(2, "0");
  const dd = String(d.getDate()).padStart(2, "0");
  return `${yyyy}-${mm}-${dd}`;
}

components/StatBar.tsx

"use client";

export function StatBar({
  label,
  value,
  max = 100,
}: {
  label: string;
  value: number;
  max?: number;
}) {
  const pct = Math.max(0, Math.min(100, Math.round((value / max) * 100)));

  return (
    <div className="rounded-xl border border-zinc-800 bg-zinc-950 p-4">
      <div className="flex items-center justify-between">
        <div className="text-xs text-zinc-400">{label}</div>
        <div className="text-sm font-semibold text-zinc-100">{value}</div>
      </div>
      <div className="mt-3 h-2 w-full rounded-full bg-zinc-900">
        <div className="h-2 rounded-full bg-zinc-100" style={{ width: `${pct}%` }} />
      </div>
      <div className="mt-2 text-[11px] text-zinc-500">{pct}%</div>
    </div>
  );
}

components/HudCard.tsx

"use client";

export function HudCard({
  title,
  value,
  sub,
}: {
  title: string;
  value: string | number;
  sub?: string;
}) {
  return (
    <div className="rounded-2xl border border-zinc-800 bg-zinc-900/40 p-6">
      <div className="text-xs text-zinc-400">{title}</div>
      <div className="mt-2 text-3xl font-semibold tracking-tight text-zinc-100">
        {value}
      </div>
      {sub ? <div className="mt-2 text-sm text-zinc-300">{sub}</div> : null}
    </div>
  );
}

components/QuestList.tsx

"use client";

type Quest = {
  id: number;
  title: string;
  description: string | null;
  quest_type: string;
  xp_reward: number;
  completed: boolean;
};

export function QuestList({
  quests,
  onToggle,
  compact = false,
}: {
  quests: Quest[];
  onToggle?: (q: Quest) => void;
  compact?: boolean;
}) {
  const badge = (t: string) => {
    const map: Record<string, string> = {
      mandatory: "border-zinc-700 bg-zinc-950 text-zinc-200",
      fitness: "border-emerald-900/60 bg-emerald-950/30 text-emerald-200",
      business: "border-sky-900/60 bg-sky-950/30 text-sky-200",
      learning: "border-violet-900/60 bg-violet-950/30 text-violet-200",
      location: "border-amber-900/60 bg-amber-950/30 text-amber-200",
    };
    return map[t] || "border-zinc-700 bg-zinc-950 text-zinc-200";
  };

  return (
    <div className="overflow-hidden rounded-2xl border border-zinc-800 bg-zinc-900/40">
      <div className="border-b border-zinc-800 px-6 py-4">
        <div className="text-sm font-semibold text-zinc-200">Today’s Quests</div>
        <div className="mt-1 text-xs text-zinc-400">
          Check off quests to track mission completion.
        </div>
      </div>

      <div className="divide-y divide-zinc-800">
        {quests.length === 0 ? (
          <div className="px-6 py-6 text-sm text-zinc-400">
            No quests found for today (cron may not have generated yet).
          </div>
        ) : (
          quests.map((q) => (
            <div key={q.id} className="px-6 py-4">
              <div className="flex items-start justify-between gap-4">
                <div className="min-w-0">
                  <div className="flex flex-wrap items-center gap-2">
                    <span
                      className={`rounded-full border px-2 py-1 text-[11px] ${badge(
                        q.quest_type
                      )}`}
                    >
                      {q.quest_type.toUpperCase()}
                    </span>
                    <span className="text-sm font-semibold text-zinc-100">
                      {q.title}
                    </span>
                    <span className="text-xs text-zinc-400">+{q.xp_reward} XP</span>
                  </div>

                  {!compact && q.description ? (
                    <div className="mt-2 text-sm text-zinc-300">{q.description}</div>
                  ) : null}
                </div>

                {onToggle ? (
                  <button
                    onClick={() => onToggle(q)}
                    className={`shrink-0 rounded-xl border px-3 py-2 text-xs ${
                      q.completed
                        ? "border-emerald-900/60 bg-emerald-950/30 text-emerald-200"
                        : "border-zinc-800 bg-zinc-950 text-zinc-200"
                    }`}
                  >
                    {q.completed ? "Completed" : "Mark done"}
                  </button>
                ) : (
                  <span
                    className={`shrink-0 rounded-xl border px-3 py-2 text-xs ${
                      q.completed
                        ? "border-emerald-900/60 bg-emerald-950/30 text-emerald-200"
                        : "border-zinc-800 bg-zinc-950 text-zinc-400"
                    }`}
                  >
                    {q.completed ? "Completed" : "Pending"}
                  </span>
                )}
              </div>
            </div>
          ))
        )}
      </div>
    </div>
  );
}


⸻

2) Dashboard page

app/dashboard/page.tsx

"use client";

import { useEffect, useMemo, useState } from "react";
import Link from "next/link";
import { supabase } from "@/lib/supabaseClient";
import { localISODate } from "@/lib/date";
import { HudCard } from "@/components/HudCard";
import { StatBar } from "@/components/StatBar";
import { QuestList } from "@/components/QuestList";

type StatsRow = {
  cohort_id: number;
  user_id: string;
  xp: number;
  rank: string;
  streak: number;
  str: number;
  sta: number;
  agi: number;
  int_stat: number;
  cha: number;
  rep: number;
  gold: number;
};

type Quest = {
  id: number;
  title: string;
  description: string | null;
  quest_type: string;
  xp_reward: number;
  completed: boolean;
};

export default function DashboardPage() {
  const today = useMemo(() => localISODate(), []);
  const [loading, setLoading] = useState(true);

  const [userId, setUserId] = useState<string | null>(null);
  const [cohortId, setCohortId] = useState<number | null>(null);

  const [stats, setStats] = useState<StatsRow | null>(null);
  const [quests, setQuests] = useState<Quest[]>([]);
  const [msg, setMsg] = useState<string>("");

  async function resolveUserAndCohort() {
    setMsg("");

    const { data: auth } = await supabase.auth.getUser();
    const uid = auth.user?.id ?? null;
    if (!uid) {
      setMsg("Please log in.");
      setLoading(false);
      return;
    }
    setUserId(uid);

    // Prefer localStorage last cohort
    const saved = Number(localStorage.getItem("sra_last_cohort_id") || "");
    if (saved) {
      setCohortId(saved);
      return;
    }

    // Otherwise load first membership
    const { data: memberships, error } = await supabase
      .from("cohort_memberships")
      .select("cohort_id")
      .eq("user_id", uid);

    if (error) {
      setMsg(error.message);
      setLoading(false);
      return;
    }

    const first = memberships?.[0]?.cohort_id ?? null;
    if (first) {
      setCohortId(first);
      localStorage.setItem("sra_last_cohort_id", String(first));
    } else {
      setMsg("No cohort found. Join with an invite code at /join.");
    }
  }

  async function loadDashboard(uid: string, cid: number) {
    setLoading(true);
    setMsg("");

    const { data: s, error: sErr } = await supabase
      .from("member_stats")
      .select("*")
      .eq("user_id", uid)
      .eq("cohort_id", cid)
      .single();

    if (sErr) {
      setMsg(sErr.message);
      setLoading(false);
      return;
    }
    setStats(s as any);

    const { data: q, error: qErr } = await supabase
      .from("daily_quests")
      .select("id,title,description,quest_type,xp_reward,completed")
      .eq("user_id", uid)
      .eq("cohort_id", cid)
      .eq("quest_date", today)
      .order("quest_type", { ascending: true });

    if (qErr) setMsg(qErr.message);
    setQuests((q || []) as any);

    setLoading(false);
  }

  useEffect(() => {
    resolveUserAndCohort();
    // eslint-disable-next-line react-hooks/exhaustive-deps
  }, []);

  useEffect(() => {
    if (userId && cohortId) loadDashboard(userId, cohortId);
    // eslint-disable-next-line react-hooks/exhaustive-deps
  }, [userId, cohortId]);

  return (
    <main className="min-h-screen bg-zinc-950 text-zinc-100">
      <div className="mx-auto max-w-6xl px-6 py-12">
        <div className="flex flex-wrap items-end justify-between gap-4">
          <div>
            <h1 className="text-2xl font-semibold tracking-tight">
              SoloREAgent Leveling System
            </h1>
            <p className="mt-1 text-sm text-zinc-300">
              HUD for {today} {cohortId ? `(Cohort #${cohortId})` : ""}
            </p>
          </div>

          <div className="flex gap-2">
            <Link
              href="/today"
              className="rounded-xl bg-zinc-100 px-4 py-2 text-sm font-semibold text-zinc-950"
            >
              Log Today
            </Link>
            <Link
              href="/join"
              className="rounded-xl border border-zinc-800 bg-zinc-950 px-4 py-2 text-sm text-zinc-200"
            >
              Join via Code
            </Link>
          </div>
        </div>

        {msg ? (
          <div className="mt-6 rounded-xl border border-zinc-800 bg-zinc-900/40 px-4 py-3 text-sm text-zinc-200">
            {msg}
          </div>
        ) : null}

        <div className="mt-8 grid grid-cols-1 gap-6 lg:grid-cols-3">
          <HudCard title="RANK" value={stats?.rank ?? (loading ? "…" : "—")} sub="Hunter Tier" />
          <HudCard title="XP" value={stats?.xp ?? (loading ? "…" : "—")} sub="Total experience" />
          <HudCard title="STREAK" value={stats?.streak ?? (loading ? "…" : "—")} sub="Days maintaining 3/4 mandatory quests" />
        </div>

        <div className="mt-6 grid grid-cols-1 gap-6 lg:grid-cols-7">
          <div className="lg:col-span-3">
            <QuestList quests={quests} compact />
          </div>

          <div className="lg:col-span-4">
            <div className="rounded-2xl border border-zinc-800 bg-zinc-900/40 p-6">
              <div className="text-sm font-semibold text-zinc-200">Stats</div>
              <div className="mt-1 text-xs text-zinc-400">
                Your character sheet updates when you log today’s numbers.
              </div>

              <div className="mt-5 grid grid-cols-1 gap-4 sm:grid-cols-2">
                <StatBar label="STR" value={stats?.str ?? 0} />
                <StatBar label="STA" value={stats?.sta ?? 0} />
                <StatBar label="AGI" value={stats?.agi ?? 0} />
                <StatBar label="INT" value={stats?.int_stat ?? 0} />
                <StatBar label="CHA" value={stats?.cha ?? 0} />
                <StatBar label="REP" value={stats?.rep ?? 0} />
                <div className="sm:col-span-2">
                  <StatBar label="GOLD" value={stats?.gold ?? 0} max={50} />
                </div>
              </div>

              <div className="mt-6 flex flex-wrap gap-2">
                <Link
                  href="/today"
                  className="rounded-xl bg-zinc-100 px-4 py-2 text-sm font-semibold text-zinc-950"
                >
                  Update Today’s Log
                </Link>
                <button
                  onClick={() => userId && cohortId && loadDashboard(userId, cohortId)}
                  className="rounded-xl border border-zinc-800 bg-zinc-950 px-4 py-2 text-sm text-zinc-200"
                >
                  Refresh
                </button>
              </div>
            </div>
          </div>
        </div>

        <div className="mt-10 text-xs text-zinc-500">
          If quests are missing: your Vercel cron should call <span className="font-mono">/api/generate-daily</span> daily.
        </div>
      </div>
    </main>
  );
}


⸻

3) Today page (log inputs + quest completion toggles)

app/today/page.tsx

"use client";

import { useEffect, useMemo, useState } from "react";
import Link from "next/link";
import { supabase } from "@/lib/supabaseClient";
import { localISODate } from "@/lib/date";
import { QuestList } from "@/components/QuestList";

type Quest = {
  id: number;
  title: string;
  description: string | null;
  quest_type: string;
  xp_reward: number;
  completed: boolean;
};

export default function TodayPage() {
  const today = useMemo(() => localISODate(), []);
  const [userId, setUserId] = useState<string | null>(null);
  const [cohortId, setCohortId] = useState<number | null>(null);

  const [quests, setQuests] = useState<Quest[]>([]);
  const [msg, setMsg] = useState<string>("");

  // Daily log form
  const [steps, setSteps] = useState<number>(0);
  const [workoutDone, setWorkoutDone] = useState<boolean>(false);
  const [learningMinutes, setLearningMinutes] = useState<number>(0);

  const [calls, setCalls] = useState<number>(0);
  const [texts, setTexts] = useState<number>(0);
  const [convos, setConvos] = useState<number>(0);
  const [leads, setLeads] = useState<number>(0);
  const [appts, setAppts] = useState<number>(0);

  const [contentDone, setContentDone] = useState<boolean>(false);
  const [notes, setNotes] = useState<string>("");

  async function getToken() {
    const { data } = await supabase.auth.getSession();
    return data.session?.access_token ?? null;
  }

  async function resolveUserAndCohort() {
    setMsg("");
    const { data: auth } = await supabase.auth.getUser();
    const uid = auth.user?.id ?? null;
    if (!uid) {
      setMsg("Please log in.");
      return;
    }
    setUserId(uid);

    const saved = Number(localStorage.getItem("sra_last_cohort_id") || "");
    if (saved) {
      setCohortId(saved);
      return;
    }

    const { data: memberships } = await supabase
      .from("cohort_memberships")
      .select("cohort_id")
      .eq("user_id", uid);

    const first = memberships?.[0]?.cohort_id ?? null;
    if (first) {
      setCohortId(first);
      localStorage.setItem("sra_last_cohort_id", String(first));
    } else {
      setMsg("No cohort found. Join with an invite code at /join.");
    }
  }

  async function loadToday(uid: string, cid: number) {
    setMsg("");

    // Load existing log (if already saved)
    const { data: logRow } = await supabase
      .from("daily_logs")
      .select("*")
      .eq("user_id", uid)
      .eq("cohort_id", cid)
      .eq("log_date", today)
      .maybeSingle();

    if (logRow) {
      setSteps(logRow.steps ?? 0);
      setWorkoutDone(!!logRow.workout_done);
      setLearningMinutes(logRow.learning_minutes ?? 0);
      setCalls(logRow.calls ?? 0);
      setTexts(logRow.texts ?? 0);
      setConvos(logRow.convos ?? 0);
      setLeads(logRow.leads ?? 0);
      setAppts(logRow.appts ?? 0);
      setContentDone(!!logRow.content_done);
      setNotes(logRow.notes ?? "");
    }

    // Load quests
    const { data: q, error: qErr } = await supabase
      .from("daily_quests")
      .select("id,title,description,quest_type,xp_reward,completed")
      .eq("user_id", uid)
      .eq("cohort_id", cid)
      .eq("quest_date", today)
      .order("quest_type", { ascending: true });

    if (qErr) setMsg(qErr.message);
    setQuests((q || []) as any);
  }

  async function saveLog() {
    setMsg("");
    if (!userId || !cohortId) {
      setMsg("Missing user or cohort. Join a cohort first.");
      return;
    }

    const token = await getToken();
    if (!token) {
      setMsg("Please log in again.");
      return;
    }

    const res = await fetch("/api/log", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        Authorization: `Bearer ${token}`,
      },
      body: JSON.stringify({
        userId,
        cohortId,
        logDate: today,
        steps,
        workout_done: workoutDone,
        learning_minutes: learningMinutes,
        calls,
        texts,
        convos,
        leads,
        appts,
        content_done: contentDone,
        notes,
      }),
    });

    const data = await res.json();
    if (!res.ok) {
      setMsg(data?.error || "Failed to save log.");
      return;
    }

    setMsg(`Saved. +${data.xpGain ?? 0} XP earned today.`);
  }

  async function toggleQuest(q: Quest) {
    if (!userId || !cohortId) return;

    const next = !q.completed;

    const { error } = await supabase
      .from("daily_quests")
      .update({
        completed: next,
        completed_at: next ? new Date().toISOString() : null,
      })
      .eq("id", q.id)
      .eq("user_id", userId)
      .eq("cohort_id", cohortId);

    if (error) {
      setMsg(error.message);
      return;
    }

    setQuests((prev) =>
      prev.map((x) => (x.id === q.id ? { ...x, completed: next } : x))
    );
  }

  useEffect(() => {
    resolveUserAndCohort();
    // eslint-disable-next-line react-hooks/exhaustive-deps
  }, []);

  useEffect(() => {
    if (userId && cohortId) loadToday(userId, cohortId);
    // eslint-disable-next-line react-hooks/exhaustive-deps
  }, [userId, cohortId]);

  return (
    <main className="min-h-screen bg-zinc-950 text-zinc-100">
      <div className="mx-auto max-w-6xl px-6 py-12">
        <div className="flex flex-wrap items-end justify-between gap-4">
          <div>
            <h1 className="text-2xl font-semibold tracking-tight">Today’s Log</h1>
            <p className="mt-1 text-sm text-zinc-300">
              {today} {cohortId ? `(Cohort #${cohortId})` : ""}
            </p>
          </div>

          <div className="flex gap-2">
            <Link
              href="/dashboard"
              className="rounded-xl border border-zinc-800 bg-zinc-950 px-4 py-2 text-sm text-zinc-200"
            >
              Back to HUD
            </Link>
            <button
              onClick={saveLog}
              className="rounded-xl bg-zinc-100 px-4 py-2 text-sm font-semibold text-zinc-950"
            >
              Save Log
            </button>
          </div>
        </div>

        {msg ? (
          <div className="mt-6 rounded-xl border border-zinc-800 bg-zinc-900/40 px-4 py-3 text-sm text-zinc-200">
            {msg}
          </div>
        ) : null}

        <div className="mt-8 grid grid-cols-1 gap-6 lg:grid-cols-7">
          <div className="lg:col-span-4">
            <div className="rounded-2xl border border-zinc-800 bg-zinc-900/40 p-6">
              <div className="text-sm font-semibold text-zinc-200">Daily Inputs</div>
              <div className="mt-1 text-xs text-zinc-400">
                Save these numbers to update XP, streak, stats, and rank.
              </div>

              <div className="mt-5 grid grid-cols-1 gap-4 sm:grid-cols-2">
                <Field label="Steps">
                  <input
                    type="number"
                    min={0}
                    value={steps}
                    onChange={(e) => setSteps(Number(e.target.value))}
                    className="w-full rounded-xl border border-zinc-800 bg-zinc-950 px-4 py-3 text-sm outline-none focus:border-zinc-600"
                  />
                </Field>

                <Field label="Learning (minutes)">
                  <input
                    type="number"
                    min={0}
                    value={learningMinutes}
                    onChange={(e) => setLearningMinutes(Number(e.target.value))}
                    className="w-full rounded-xl border border-zinc-800 bg-zinc-950 px-4 py-3 text-sm outline-none focus:border-zinc-600"
                  />
                </Field>

                <Toggle
                  label="Workout Completed"
                  checked={workoutDone}
                  onChange={setWorkoutDone}
                />

                <Toggle
                  label="Content Posted"
                  checked={contentDone}
                  onChange={setContentDone}
                />

                <Field label="Calls">
                  <input
                    type="number"
                    min={0}
                    value={calls}
                    onChange={(e) => setCalls(Number(e.target.value))}
                    className="w-full rounded-xl border border-zinc-800 bg-zinc-950 px-4 py-3 text-sm outline-none focus:border-zinc-600"
                  />
                </Field>

                <Field label="Texts / DMs">
                  <input
                    type="number"
                    min={0}
                    value={texts}
                    onChange={(e) => setTexts(Number(e.target.value))}
                    className="w-full rounded-xl border border-zinc-800 bg-zinc-950 px-4 py-3 text-sm outline-none focus:border-zinc-600"
                  />
                </Field>

                <Field label="Conversations">
                  <input
                    type="number"
                    min={0}
                    value={convos}
                    onChange={(e) => setConvos(Number(e.target.value))}
                    className="w-full rounded-xl border border-zinc-800 bg-zinc-950 px-4 py-3 text-sm outline-none focus:border-zinc-600"
                  />
                </Field>

                <Field label="Leads Captured">
                  <input
                    type="number"
                    min={0}
                    value={leads}
                    onChange={(e) => setLeads(Number(e.target.value))}
                    className="w-full rounded-xl border border-zinc-800 bg-zinc-950 px-4 py-3 text-sm outline-none focus:border-zinc-600"
                  />
                </Field>

                <Field label="Appointments Set">
                  <input
                    type="number"
                    min={0}
                    value={appts}
                    onChange={(e) => setAppts(Number(e.target.value))}
                    className="w-full rounded-xl border border-zinc-800 bg-zinc-950 px-4 py-3 text-sm outline-none focus:border-zinc-600"
                  />
                </Field>

                <div className="sm:col-span-2">
                  <Field label="Notes">
                    <textarea
                      value={notes}
                      onChange={(e) => setNotes(e.target.value)}
                      rows={4}
                      className="w-full rounded-xl border border-zinc-800 bg-zinc-950 px-4 py-3 text-sm outline-none focus:border-zinc-600"
                      placeholder="Wins, misses, contacts, follow-up plan…"
                    />
                  </Field>
                </div>
              </div>

              <div className="mt-6 flex flex-wrap gap-2">
                <button
                  onClick={saveLog}
                  className="rounded-xl bg-zinc-100 px-4 py-2 text-sm font-semibold text-zinc-950"
                >
                  Save Log
                </button>

                <button
                  onClick={() => userId && cohortId && loadToday(userId, cohortId)}
                  className="rounded-xl border border-zinc-800 bg-zinc-950 px-4 py-2 text-sm text-zinc-200"
                >
                  Reload
                </button>
              </div>

              <div className="mt-4 text-xs text-zinc-500">
                Tip: steps ≥ 7,000 + workout + (5 convos or 1 appt) + 20 min learning keeps streak alive.
              </div>
            </div>
          </div>

          <div className="lg:col-span-3">
            <QuestList quests={quests} onToggle={toggleQuest} />
          </div>
        </div>
      </div>
    </main>
  );
}

function Field({ label, children }: { label: string; children: React.ReactNode }) {
  return (
    <div>
      <div className="text-xs text-zinc-400">{label}</div>
      <div className="mt-2">{children}</div>
    </div>
  );
}

function Toggle({
  label,
  checked,
  onChange,
}: {
  label: string;
  checked: boolean;
  onChange: (v: boolean) => void;
}) {
  return (
    <div className="rounded-xl border border-zinc-800 bg-zinc-950 p-4">
      <div className="flex items-center justify-between">
        <div className="text-sm text-zinc-200">{label}</div>
        <button
          onClick={() => onChange(!checked)}
          className={`rounded-lg border px-3 py-2 text-xs ${
            checked
              ? "border-emerald-900/60 bg-emerald-950/30 text-emerald-200"
              : "border-zinc-800 bg-zinc-950 text-zinc-300"
          }`}
        >
          {checked ? "YES" : "NO"}
        </button>
      </div>
    </div>
  );
}


⸻

4) (Important) One tiny tweak to your daily_quests table

Your toggleQuest() updates completed_at. Make sure daily_quests has that column (it does in earlier schema). If not, add:

alter table public.daily_quests
add column if not exists completed_at timestamptz;


⸻

What you’ll have after this
	•	Dashboard HUD shows rank/xp/streak + stat bars + today quests
	•	Today page logs all metrics and calls /api/log to update XP/stats
	•	Quest checklist can be manually toggled (good MVP)

⸻

If you want the next upgrade (high impact): I can make quests auto-complete based on your saved log (e.g., steps ≥ 7k auto-checks MOVE, convos ≥ 5 auto-checks “5 Real Conversations”, etc.).